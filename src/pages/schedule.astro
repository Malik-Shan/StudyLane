---
export const prerender = false;
import DefaultLayout from '../layouts/DefaultLayout.astro';
import {app} from '../firebase/server';
import {getAuth} from 'firebase-admin/auth';

const auth = getAuth(app);
if(!Astro.cookies.has('session')){
	return Astro.redirect('/login');
}
const sessionCookie = Astro.cookies.get('session').value;
let decodedCookie;
try {
	decodedCookie = await auth.verifySessionCookie(sessionCookie);
}catch(err){
	Astro.cookies.set('session','', {expires : new Date(0)});
	return Astro.redirect('/login');
}
const user = await auth.getUser(decodedCookie.uid);
if(!user){
	Astro.cookies.set('session','', {expires : new Date(0)});
	return Astro.redirect('/login');
}
import * as schedule from '../content/schedule/schedule.md';
---
<DefaultLayout title={schedule.frontmatter.title}>
	<section class='container mx-auto pt-1 pb-[calc(60px_+_10px)] max-sm:pb-[60px]'>
		{
		schedule.frontmatter.imgSrc.map((i) => <img src={i} class='w-full'/>)
		}
	</section>
</DefaultLayout>
