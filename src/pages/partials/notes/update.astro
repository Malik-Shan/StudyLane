---
import {db,Audits as zAudits,eq} from 'astro:db';
export const prerender = false;
export  const partial = true;
import Note from '../../../components/Note.astro';
const Id = parseInt(Astro.request.headers.get('id'));
const date = parseInt(Astro.request.headers.get('nDate'));
const fd = await Astro.request.formData();
const text = fd.get('text')?.toString();
const notetext = text.replace(/\r?\n/g, '\\n');
const data = notetext.replace(/\\n/g, '<br>');
const r = await db.update(zAudits).set({links:notetext}).where(eq(zAudits.id,Id));
if(r.rowsAffected !== 1){
	return new Response("Error updating ",{
		status:400,
	})
}
---
<Note id={Id} data={data} date={date} />
